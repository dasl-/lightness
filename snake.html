<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js'></script>
    <title>SNAKE</title>

    <style>
      body {
        background-color:#1e1f23;
        margin:0;
        padding:0;
        overflow:hidden;
      }
      .wrapper {
        display:flex;
        flex-flow:column nowrap;
        justify-content:center;
        align-items:center;
        height:90vh;
        width:100vw;
        overflow:hidden;
      }

/*
      .topquad {
        position:absolute;
        display:block;
        width:0;
        height:0;
        border-left:50vw solid transparent;
        border-right:50vw solid transparent;
        border-top:50vw solid #fff;
        z-index:2;
      }

*/


      .button {
        width:100px;
        height:294px;
        max-height:20vh;
        background-repeat: no-repeat;
        background-size: contain;
        background-position:center;
        background-image:url("snake.png");
      }
      .lrwrapper {
        display:flex;
        justify-content:space-between;
        max-width:100vw;
        max-height:15vh;
        width:300px;
        margin-top:-5vh;
      }
      .left {
        transform:rotate(-90deg);
      }
      .right {
        transform:rotate(90deg);
      }
      .down {
        transform:rotate(180deg);
      }
      .new-game {
        color:#fff;
      }
      @media screen and (min-width:500px) {
        .wrapper {
          height:100vh;
        }
        .button {
          max-height:38vh;
        }
        .lrwrapper {
          min-width:60vh;
          max-height:10vh;
          margin-bottom:15vh;
          margin-top:-15vh;
      }
    </style>

    <script>
      $(document).ready(function () {
        $(".button").click(function() {
          $(".button").css("background-image", "url('snake.png')");
          $(this).css("background-image", "url('snake-active.png')");
          var direction = $(this).data("direction");
          $.post({
            url: "/api/snake_move",
            data: JSON.stringify({move: direction})
          });
        });

        $(".new-game").click(function(){
            $.post({
                url: "/api/enqueue_game",
                data: JSON.stringify({title: 'snake'})
            });
        });
      });


      //Keyboard input
      $(document).keydown(function(e) {
        var keyinput = e.keyCode;
        var direction;
        if (keyinput == 38) {
          direction = 1;
        }
        if (keyinput == 40) {
          direction = 2;
        }
        if (keyinput == 37) {
          direction = 3;
        }
        if (keyinput == 39) {
          direction = 4;
        }
        if(direction) {
          $(".button").css("background-image", "url('snake.png')");
          $(".button[data-direction='" + direction + "']").css("background-image", "url('snake-active.png')");
          $.post({
            url: "/api/snake_move",
            data: JSON.stringify({move: direction})
          });
        }
      });
    </script>


  </head>
  <body>

  <div class="topquad"></div>

  <div class="wrapper">
    <div class="button up" data-direction="1"></div>
    <div class="lrwrapper">
      <div class="button left" data-direction="3"></div>
      <div class="button right" data-direction="4"></div>
    </div>
    <div class="button down" data-direction="2"></div>

    <div class="new-game">new game</div>

  </div>

</body>
</html>